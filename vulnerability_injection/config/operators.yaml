# MuSe Vulnerability Operators Configuration
# These operators inject security vulnerabilities into Solidity contracts

operators:
  RE:
    name: "Reentrancy"
    severity: "critical"
    description: "Swaps state update and external call order, violating checks-effects-interactions pattern"
    detection_tools:
      - slither
      - mythril
      - aderyn
    cwe: "CWE-841"
    example:
      before: "balances[msg.sender] -= amount; msg.sender.call{value: amount}('')"
      after: "msg.sender.call{value: amount}(''); balances[msg.sender] -= amount"

  TX:
    name: "tx.origin Authentication"
    severity: "high"
    description: "Replaces msg.sender with tx.origin in authentication checks"
    detection_tools:
      - slither
      - aderyn
    cwe: "CWE-287"
    example:
      before: "require(msg.sender == owner)"
      after: "require(tx.origin == owner)"

  TD:
    name: "Timestamp Dependence"
    severity: "medium"
    description: "Replaces block properties (block.number, etc.) with block.timestamp"
    detection_tools:
      - slither
      - mythril
    cwe: "CWE-829"
    example:
      before: "if (block.number >= deadline)"
      after: "if (block.timestamp >= deadline)"

  UC:
    name: "Unchecked Call"
    severity: "high"
    description: "Removes require() from low-level calls (.call, .delegatecall, etc.)"
    detection_tools:
      - slither
      - aderyn
    cwe: "CWE-252"
    example:
      before: "require(address.call(data))"
      after: "address.call(data)"

  US:
    name: "Unchecked Send"
    severity: "high"
    description: "Removes return value check from .send() operations"
    detection_tools:
      - slither
      - aderyn
    cwe: "CWE-252"
    example:
      before: "require(address.send(amount))"
      after: "address.send(amount)"

  UTR:
    name: "Unchecked Transfer"
    severity: "high"
    description: "Removes check from token .transfer() and .transferFrom() calls"
    detection_tools:
      - slither
      - aderyn
    cwe: "CWE-252"
    example:
      before: "require(token.transfer(to, amount))"
      after: "token.transfer(to, amount)"

  IUO:
    name: "Integer Overflow/Underflow"
    severity: "high"
    description: "Removes SafeMath protection or adds unchecked blocks"
    detection_tools:
      - slither
      - mythril
    cwe: "CWE-190"
    example:
      before: "totalSupply.add(amount)"
      after: "unchecked { totalSupply + amount }"

  USD:
    name: "Unprotected Selfdestruct"
    severity: "critical"
    description: "Changes selfdestruct function visibility from private/internal to public"
    detection_tools:
      - slither
      - aderyn
    cwe: "CWE-284"
    example:
      before: "function destroy() private { selfdestruct(owner); }"
      after: "function destroy() public { selfdestruct(owner); }"

  DTU:
    name: "Delegatecall to Untrusted"
    severity: "critical"
    description: "Replaces delegatecall target with externally-controllable address"
    detection_tools:
      - slither
      - aderyn
    cwe: "CWE-829"
    example:
      before: "implementation.delegatecall(data)"
      after: "delegateAddressDTU.delegatecall(data)  // with setDelegateDTU() function added"

  UR1:
    name: "Unused Return (Assignment)"
    severity: "medium"
    description: "Ignores return value by initializing to default value first"
    detection_tools:
      - slither
    cwe: "CWE-252"
    example:
      before: "result = external.calculate()"
      after: "result = 0; external.calculate()"

  UR2:
    name: "Unused Return (Declaration)"
    severity: "medium"
    description: "Ignores return value in variable declaration"
    detection_tools:
      - slither
    cwe: "CWE-252"
    example:
      before: "uint256 result = external.calculate()"
      after: "uint256 result = 0; external.calculate()"

# Default operators to enable (high-impact vulnerabilities)
defaults:
  enabled:
    - RE
    - TX
    - UC
    - IUO
    - USD
    - DTU

# Severity levels
severity_levels:
  critical:
    color: "red"
    priority: 1
  high:
    color: "orange"
    priority: 2
  medium:
    color: "yellow"
    priority: 3
  low:
    color: "blue"
    priority: 4
